// gradle tasks --all   查看项目中定义的所有 Task

task setWhoamiProperty(group: 'bga') {
    doLast {
        new ByteArrayOutputStream().withStream { os ->
            def result = exec {
                executable = 'whoami'
                standardOutput = os
            }
            rootProject.ext.whoami = os.toString().trim()
        }
    }
}
tasks.create(name: 'setHostnameProperty') {
    group = 'bga'
    doFirst {
        new ByteArrayOutputStream().withStream { os ->
            def result = exec {
                executable = 'hostname'
                standardOutput = os
            }
            rootProject.ext.hostname = os.toString().trim()
        }
    }
}
task printBuildInfo {
    group = 'bga'
    dependsOn setWhoamiProperty, 'setHostnameProperty' // 默认按拼音字母排序，W 在 H 之后

    println "\nprintBuildInfo this：" + this
    println "printBuildInfo owner：" + owner
    println "printBuildInfo delegate：" + delegate + '\n'

    doFirst {
        println "\ndoFirst this：" + this
        println "doFirst owner：" + owner
        println "doFirst delegate：" + delegate
        // 这里的 name 其实是 delegate.name
        println "\n$name $rootProject.ext.whoami"
        println "$name $rootProject.ext.hostname\n"
    }
}

//def startBuildTime
//this.afterEvaluate { Project project ->
//    def firstTask = project.tasks.findByName('preBuild')
//    firstTask.doFirst {
//        startBuildTime = System.currentTimeMillis()
//    }
//    def lastTask = project.tasks.findByName('build')
//    lastTask.doLast {
//        println "总构建耗时 ${System.currentTimeMillis() - startBuildTime}ms"
//    }
//}